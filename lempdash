#!/usr/bin/env bash
# Display colorized information output
ADDRESSEE="Hey boss, "
DONTF="don't forget to "
AVAIL_OPS="(site, db, bu)"
HINT_TOP="Acceptable arguments: cr, rm"

echo "Hi! I'm LEMPDash 0.0.2!"

if [ $# -eq 0 ]; then
	echo $HINT_TOP
# CREATION OPERATIONS
elif [ $1 = "cr" ]; then
	if [ -z "$2" ]; then
			echo $ADDRESSEE$DONTF"specify creation operation: ldash cr OPERATION"$AVAIL_OPS	
	elif [ $2 = "site" ]; then	
		if [ $# = 3 ]; then
			echo "Creating site..." $3	
			/opt/lempdash/tasks/nginx/createblock "$3"
		else
			echo $ADDRESSEE$DONTF"specify a site name: ldash cr site SITENAME"
		fi
	elif [ $2 = "db" ]; then	
		if [ $# = 5 ]; then
			echo "Creating database..." $3 	
			/opt/lempdash/tasks/mysql/createdb "$3" "$4" "$5"
		else
			echo $ADDRESSEE$DONTF"specify the database parameters: ldash cr db DBNAME DBUSER 'DBPASS"
		fi
	fi
# REMOVAL OPERATIONS
elif [ $1 = "rm" ]; then
	if [ -z "$2" ]; then
			echo $ADDRESSEE$DONTF"specify a valid removal operation: ldash rm OPERATION"$AVAIL_OPS	
	# REMOVE SITE
	elif [ $2 = "site" ]; then
		if [ $# = 3 ]; then	
			echo "Removing site: " $3	
			/opt/lempdash/tasks/nginx/removeblock "$3"
		else 
			echo $ADDRESSEE$DONTF"specify a site name: ldash rm site SITENAME"
		fi
	# REMOVE DATABASE
	elif [ $2 = "db" ]; then
		if [ $# = 3 ]; then	
			echo "Dropping database: " $3
			/opt/lempdash/tasks/mysql/removedb "$3"
		else
			echo $ADDRESSEE$DONTF"specify a database name: ldash rm db SITENAME"
		fi
	# REMOVE DATABASE USER
	elif [ $2 = "dbuser" ]; then
		if [ $# = 3 ]; then	
			echo "Dropping user: " $3	
			/opt/lempdash/tasks/mysql/removeuser "$3"
		else
			echo $ADDRESSEE$DONTF"specify a user name: ldash rm dbuser USERNAME"
		fi	
	else
		echo $ADDRESSEE$DONTF"specify a valid removal operation: ldash rm OPERATION"$AVAIL_OPS
	fi
# BACKUP OPERATIONS
elif [ $1 = "bu" ]; then
	if [ -z "$2" ]; then
			echo $ADDRESSEE$DONTF"specify a valid backup operation: ldash bu OPERATION"$AVAIL_OPS
	# BACK UP SITE
	elif [ $2 = "site" ]; then
		if [ $# = 3 ]; then	
			echo "Backing up site: " $3	
			/opt/lempdash/tasks/nginx/backupsite "$3"
			echo "Backing up nginx server block for site: " $3
			/opt/lempdash/tasks/nginx/backupblock "$3"
		else 
			echo $ADDRESSEE$DONTF"specify a site name: ldash bu site SITENAME"
		fi
	elif [ $2 = "db" ]; then
		if [ $# = 3 ]; then	
			echo "Backing up database: " $3	
			/opt/lempdash/tasks/mysql/backupdb "$3"		
		else 
			echo $ADDRESSEE$DONTF"specify a database name: ldash bu db DATABASENAME"
		fi
	fi
else
	echo $HINT_TOP
fi

exit 10